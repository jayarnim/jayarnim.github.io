---
order: 5
title: Fourier Analysis
date: 2025-08-05
categories: [BAYES, 4.stochastic process]
tags: [Bayesian, Deep Learning, Stochastic Process, Time Series, Nonparametric Estimation, Gaussian Process, Multi-Variate Gaussian Dist., Fourier]
math: true
image:
    path: /_post_refer_img/BayesianModeling/4.StochasticProcess/Thumbnail.jpg
---

## Euler's formula
-----

- **Euler's formula** is a formula that shows that the Taylor series of a complex exponential function can be expressed as a trigonometric function.

    $$\begin{aligned}
    \exp{i\theta}
    &=\sum_{n=0}^{\infty}{\frac{(i\theta)^{n}}{n!}}\\
    &=\sum_{k=0}^{\infty}{\frac{(i\theta)^{2k}}{(2k)!}}+\sum_{k=0}^{\infty}{\frac{(i\theta)^{2k+1}}{(2k+1)!}}\\
    &=\sum_{k=0}^{\infty}{\frac{(-1)^{k}\theta^{2k}}{(2k)!}}+\sum_{k=0}^{\infty}{\frac{\left(i(-1)^{k}\theta\right)^{2k+1}}{(2k+1)!}}\\
    &=\cos{\theta}+i\sin{\theta}
    \end{aligned}$$

- **complex plane** is a coordinate plane that expresses **complex numbers** $$Z=x+i \cdot y$$ **as vectors on the vector space** $$\mathbb{R}^{2}:=\mathrm{span}\left\{\mathbf{e}_{X},\mathbf{e}_{Y}\right\}$$, which consists of the **real axis basis** $$\mathbf{e}_{X}=\begin{bmatrix}1\\0\end{bmatrix}$$ and the **imaginary axis basis** $$\mathbf{e}_{Y}=\begin{bmatrix}0\\1\end{bmatrix}$$.

    $$
    \mathbf{v}_{Z}:=\mathbf{e}_{X}x+\mathbf{e}_{Y}y \in \mathbb{R}^{2}
    $$

- **rotation transformation** is a linear transformation that rotates a vector on a coordinate plane **counterclockwise by $\theta$ around the $X$ axis**.

    $$
    R:=\begin{bmatrix}
    \cos{\theta}&-\sin{\theta}\\
    \sin{\theta}&\cos{\theta}
    \end{bmatrix}
    $$

- Therefore, Euler's formula suggests that the **complex exponential function** $\exp{i\theta}$ rotates the complex number $Z$ by $\theta$ in the complex plane **counterclockwise around the real axis**.

    $$\begin{aligned}
    R\left(\mathbf{e}_{X};\theta\right)
    &=1\cdot\begin{bmatrix}\cos{\theta}\\\sin{\theta}\end{bmatrix} + 0\cdot\begin{bmatrix}-\sin{\theta}\\\cos{\theta}\end{bmatrix}\\
    &\leftrightarrow \cos{\theta}+i\sin{\theta}
    \end{aligned}$$

## Fourier series
-----

- **Fourier series** is a technique for mapping a **periodic signal** $X_{T}(t)$, whose pattern repeats with a period of $T$ defined in the time domain, to a **frequency domain composed of discrete sinusoid** $\phi_{k}(t)$ by approximating it as a linear combination of discrete sinusoid.

    $$
    X_{T}(t)\approx\sum_{k=-\infty}^{\infty}{a_{k}\phi_{k}(t)}
    $$

- **sinusoid** is a unit vector that **rotates at a unique speed in the complex plane**, and corresponds to the **basis vector** of a vector space.

    $$\begin{aligned}
    \phi_{k}(t)
    :=\exp{i\omega_{k}t}
    =\cos{\omega_{k}t}+i\sin{\omega_{k}t}
    \end{aligned}$$

- **frequency** is the **unique rotational speed of a sinusoid**, which corresponds to the **direction of the basis vector** in vector space.
    - $\nu_{0}=1/T$(Hz): The number of vibrations per second as the **fundamental frequency**
    - $\omega_{0}=\nu_{0}\cdot 2\pi$(rad/s): Angular velocity in revolutions per second as the **fundamental angular frequency**
    - $\nu_{k}=k\cdot\nu_{0},\omega_{k}=k\cdot\omega_{0}$: Integer multiple of the fundamental frequency as the **harmonic**

- Sinusoids that share a period $T$ are **orthogonal to each other**.

    $$\begin{aligned}
    \langle\phi_{m}(t),\phi_{n}(t)\rangle
    &=\begin{cases}
    T\quad &(m = n)\\
    0\quad &(m \ne n)
    \end{cases}
    \end{aligned}$$

- **Fourier coefficients** represent the **average amplitude of a sinusoids** per unit time, i.e., the **frequency components**. In vector space, they correspond to the **magnitude (coordinate value)** of the result of an evaluation operation in the basis direction.

    $$\begin{aligned}
    \delta_{n}\left[X_{T}(t)\right]
    &=\langle X_{T}(t),\phi_{n}(t)\rangle\\
    &\approx \left\langle \sum_{k=-\infty}^{\infty}{a_{k}\phi_{k}(t)},\phi_{n}(t) \right\rangle\\
    &=\sum_{k=-\infty}^{\infty}{a_{k}\left\langle\phi_{k}(t),\phi_{n}(t)\right\rangle}\\
    &=a_{n}T + \sum_{k \ne n}{a_{k} \cdot 0}\\
    &=a_{n}T
    \end{aligned}$$

## Fourier transform
-----

### Fourier transform

- Fourier series maps a **periodic signal** into **frequency components** in a **countable infinite-dimensional space** consisting of **discrete basis**.

    $$\begin{aligned}
    X_{T}(t) \mapsto \left\{a_{k}\mid k\in\mathbb{Z}\right\} \in \mathrm{span}\left\{\phi_{k}(t)=\exp{ik\omega_{0}t}\mid k\in\mathbb{Z}\right\}
    \end{aligned}$$

- **Non-periodic signal** can be viewed as a periodic signal with $T\to\infty$, which results in the **generalization of the discrete harmonic** $\{k\omega_{0}\mid k\in\mathbb{Z}\}$ into the **continuous harmonic** $\omega \in \mathbb{R}$.

    $$
    T \to \infty \Leftrightarrow \Delta\omega\to 0 \quad (\because\omega_{0}=2\pi/T)
    $$

- $a_{k}T$, **total amplitude per period of a discrete sinusoids**, generalizes to the $\mathcal{X}(\omega)$, **amplitude of a continuous sinusoids**, as the period diverges to infinity ($T\to\infty$) and the fundamental converges to $0$ ($\Delta\omega\to 0$).

    $$\begin{aligned}
    \mathcal{X}(\omega)
    &= \lim_{\Delta\omega\to 0}{a_{k}T}\\
    &= \lim_{\Delta\omega\to 0}{\left\langle X_{T}(t),\phi_{k}(t)\right\rangle}\\
    &= \left\langle \lim_{\Delta\omega\to 0}{X_{T}(t)},\lim_{\Delta\omega\to 0}{\phi_{k}(t)}\right\rangle\\
    &= \left\langle X(t),\phi(t)\right\rangle
    \end{aligned}$$

- In short, the **Fourier transform** is a generalization of the Fourier series, which maps a **non-periodic signal** into a spectrum on a **non-countable infinite-dimensional space** consisting of a **continuous basis**.

    $$\begin{aligned}
    X(t) \mapsto \mathcal{X}(\omega) \in \mathrm{span}\left\{\phi(t;\omega)=\exp{i \omega t}\mid\omega\in\mathbb{R}\right\}
    \end{aligned}$$

### Inverse Fourier transform

- **Inverse Fourier transform** is an operation that **reduces the spectrum $\mathcal{X}(\omega)$ to an aperiodic signal $X(t)$**, and is performed as an **inner product with the dual basis**.

    $$
    \langle\cdot,\phi^{*}(t)\rangle_{\omega}: \mathcal{X}(\omega) \mapsto X(t)
    $$

- The **dual basis of an orthonormal basis** is simplified to a basis whose inner product with the original basis is $1$.

    $$
    \langle\phi_{k}(t),\phi_{k}^{*}(t)\rangle=1
    $$

- $m=n$:

    $$\begin{aligned}
    \langle\phi_{m}(t),\phi_{n}(t)\rangle
    &=\int_{t \in T}{\exp{i(m-n)\omega_{0}t}\mathrm{d}t}\\
    &=\int_{t \in T}{1\mathrm{d}t}\\
    &=T
    \end{aligned}$$

- $m \ne n$:

    $$\begin{aligned}
    \langle\phi_{m}(t),\phi_{n}(t)\rangle
    &=\int_{t \in T}{\exp{i(m-n)\omega_{0}t}\mathrm{d}t}\\
    &=\frac{1}{i(m-n)\omega_{0}}\left(\exp{i(m-n)\omega_{0}T}-1\right)\\
    &=0\\
    \because\exp{i(m-n)\omega_{0}T}
    &=\underbrace{\cos{(m-n)2\pi}}_{=1}+i\underbrace{\sin{(m-n)2\pi}}_{=0}
    \end{aligned}$$

- Therefore, the **dual basis of a discrete basis** is defined as follows:

    $$
    \phi_{k}^{*}(t)=\frac{1}{T}\exp{-ik\omega_{0}t}
    $$

- When extending the dual basis of a discrete basis to a continuous domain, the **normalization constant** is replaced by $1/T \to 1/2\pi$.

    $$\begin{aligned}
    \frac{1}{T}\sum_{k}{(\cdot)}
    =\frac{1}{2\pi}\sum_{k}{(\cdot)\Delta\omega}
    \xrightarrow{\Delta\omega\to 0}
    \frac{1}{2\pi}\int{(\cdot)\mathrm{d}\omega}
    \end{aligned}$$

- Therefore, the **dual basis of a continuous basis** is defined as follows:

    $$
    \phi^{*}(t)=\frac{1}{2\pi}\exp{-i\omega t}
    $$

## Random Fourier Feature
-----

### Random Fourier Feature

- **Bochner's theorem** states that a shift-invariant, continuous, and positive definite kernel function can be expressed as a **Fourier transform** whose **spectrum is a probability function of continuous frequency $\omega$**.

    $$\begin{aligned}
    k(x-x^{\prime})
    &=\int_{\mathbb{R}^{d}}{\phi(x-x^{\prime})p(\omega)\mathrm{d}\omega}\\
    &=\int_{\mathbb{R}^{d}}{\phi(x)\phi^{*}(x^{\prime})p(\omega)\mathrm{d}\omega}\\
    &=\left\langle\Phi(x),\Phi(x^{\prime})\right\rangle_{p(\omega)}
    \end{aligned}$$

- This indicates that the kernel function can be expressed as an **infinite-dimensional inner product of continuous sinusoids**.

    $$\begin{aligned}
    \Phi(x)
    =\begin{bmatrix}\exp{i\omega_{1}x}\cdot \sqrt{p(\omega_{1})}\\\exp{i\omega_{2}x}\cdot \sqrt{p(\omega_{2})}\\\vdots\\\exp{i\omega_{\infty}x}\cdot \sqrt{p(\omega_{\infty})}\end{bmatrix},
    \quad \Phi^{*}(x^{\prime})
    =\begin{bmatrix}\exp{-i\omega_{1}x^{\prime}}\cdot \sqrt{p(\omega_{1})}\\\exp{-i\omega_{2}x^{\prime}}\cdot \sqrt{p(\omega_{2})}\\\vdots\\\exp{-i\omega_{\infty}x^{\prime}}\cdot \sqrt{p(\omega_{\infty})}\end{bmatrix}
    \end{aligned}$$

- **Random Fourier Features** is a technique that **replaces the infinite-dimensional complex inner product with a finite-dimensional real inner product** through Monte Carlo approximation in the Fourier transform of a kernel function.

    $$\begin{aligned}
    \int_{\mathbb{R}^{d}}{\phi(x)\phi^{*}(x^{\prime})p(\omega)\mathrm{d}\omega}
    &\approx \frac{1}{\sqrt{M}}\sum_{m=1}^{M}{\psi_{m}(x)\psi^{*}_{m}(x^{\prime})}, \quad \omega_{m} \sim p(\omega)
    \end{aligned}$$

- Continuous sinusoid of infinite dimension $\phi(x)$ is approximated by a discrete sinusoid of finite dimension $\psi_{m}(x)$ with **frequency $\omega_{m}$ sampled from the spectral density $p(\omega)$**.

    $$\begin{gathered}
    \phi(x)=\exp{i\omega x}\cdot\sqrt{p(\omega)}, \quad \omega \in \mathbb{R}\\
    \Downarrow\\
    \psi_{m}(x)=\frac{1}{\sqrt{M}}\exp{i\omega_{m}x}, \quad \omega_{m} \sim p(\omega)
    \end{gathered}$$

- Accordingly, the infinite-dimensional inner product of continuous sinusoids, $\phi(x)$, is **approximated by the finite-dimensional inner product of discrete sinusoids, $\psi(x)$**.

    $$\begin{aligned}
    \Psi_{M}(x)
    =\frac{1}{\sqrt{M}}\begin{bmatrix}\exp{i\omega_{1}x}\\\exp{i\omega_{2}x}\\\vdots\\\exp{i\omega_{M}x}\end{bmatrix},
    \quad \Psi^{*}_{M}(x^{\prime})
    =\frac{1}{\sqrt{M}}\begin{bmatrix}\exp{-i\omega_{1}x}\\\exp{-i\omega_{2}x}\\\vdots\\\exp{-i\omega_{M}x}\end{bmatrix}
    \end{aligned}$$

### sinusoids simplification

- The integral of a sinusoid $\phi(x)$ on a symmetric interval can be simplified as follows:

    $$\begin{aligned}
    \int_{-\infty}^{\infty}{\phi(x)\mathrm{d}\omega}
    &=\int_{-\infty}^{\infty}{\cos{\omega x}\mathrm{d}\omega} + \underbrace{\int_{-\infty}^{\infty}{i\sin{\omega x}\mathrm{d}\omega}}_{=0}\\
    &= \int_{-\infty}^{\infty}{\cos{\omega x}\mathrm{d}\omega}
    \quad \because \begin{cases}\cos{-x}=\cos{x}\\\sin{-x}=-\sin{x}\end{cases}
    \end{aligned}$$

- Trigonometric Identity:

    $$
    2\cos{A}\cos{B}=\cos{(A-B)}+\cos{(A+B)}
    $$

- Application:

    $$\begin{aligned}
    2\cos(\omega_{m} x + b_{m})\cos(\omega_{m} x^{\prime} + b_{m})
    &=\cos(\omega_{m}(x-x^{\prime}))+\cos(\omega_{m}(x+x^{\prime})+2b_{m})
    \end{aligned}$$

- Since the expected value of the **cosine function** in the interval $[0,2\pi)$ is $0$:

    $$\begin{aligned}
    2\mathbb{E}_{b}\left[\cos(\omega x + b)\cos(\omega x^{\prime} + b)\right]
    &=\mathbb{E}_{b}\left[\cos(\omega(x-x^{\prime}))\right]+\mathbb{E}_{b}\left[\cos(\omega(x+x^{\prime})+2b)\right]\\
    &=\cos(\omega(x-x^{\prime})) \quad \mathrm{s.t.} \quad b_{m}\sim\mathrm{Uniform}(0,2\pi]
    \end{aligned}$$

- Finally, the continuous complex sinusoid $\phi(x)$ of infinite dimension can be simplified into the **discrete real sinusoid $\psi_{m}(x)$ of finite dimension**.

    $$\begin{aligned}
    \psi_{m}(x)
    &=\sqrt{\frac{2}{M}}\cos(\omega_{m}x+b_{m}), \quad \mathrm{for} \quad \begin{cases}\omega_{m} &\sim p(\omega)\\b_{m}&\sim\mathrm{Uniform}(0,2\pi]\end{cases}
    \end{aligned}$$

- Accordingly, the infinite-dimensional complex inner product of continuous sinusoids is simplified to the **finite-dimensional real inner product of discrete sinusoids**.

    $$\begin{aligned}
    \Psi_{M}(x)
    &=\sqrt{\frac{2}{M}}\begin{bmatrix}\cos{(\omega_{1}x+b_{1})}\\\cos{(\omega_{2}x+b_{2})}\\\vdots\\\cos{(\omega_{M}x+b_{M})}\end{bmatrix}, \quad \mathrm{for} \quad \begin{cases}\omega_{m} &\sim p(\omega)\\b_{m}&\sim\mathrm{Uniform}(0,2\pi]\end{cases}
    \end{aligned}$$