---
order: 6
title: kNN
date: 2024-01-06
categories: [Artificial Intelligence, Machine Learning]
tags: [writing]
math: true
image:
  path: /img/MachineLearning/Thumbnail.jpg
---

# ğŸ’¡ k-Nearest Neighbors
-----

- **ì •ì˜** : ê¸°í•˜ ê±°ë¦¬ë¥¼ ê·œì¹™ìœ¼ë¡œ í•˜ì—¬ ê´€ì¸¡ì¹˜ë¥¼ ë¶„ë¥˜í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜

    ![01](/img/MachineLearning/06-01.png){: width="100%"}

- **í•œê³„ì **
    - **ê²€ìƒ‰ ë¹„ìš© ë¬¸ì œ**
        - ê´€ì¸¡ì¹˜ ê°¯ìˆ˜ë§Œí¼ ê±°ë¦¬ë¥¼ ê³„ì‚°í•´ì•¼ í•¨

    - **ê±°ë¦¬ ì¸¡ì • í•¨ìˆ˜ ì„¤ì • ë¬¸ì œ**
        - ë¶„ì„ê°€ê°€ ë¬¸ì œì— ì í•©í•œ í•¨ìˆ˜ë¥¼ íŒë‹¨í•´ì•¼ í•¨
        - ê³ ì°¨ì›ìœ¼ë¡œ ê°ˆìˆ˜ë¡ ê±°ë¦¬ ê°œë…ì´ ë¬´ì˜ë¯¸í•´ì§
        - ë²”ì£¼í˜• ë³€ìˆ˜ì˜ ê²½ìš° ê° ë²”ì£¼ ê°„ ê±°ë¦¬ë¥¼ ì •ì˜í•´ì•¼ í•¨

# ğŸ’¡ ê¸°í•˜ ê±°ë¦¬ ì¸¡ì • ë°©ë²•
-----

### ë§¨í•´íŠ¼ ê±°ë¦¬ ì¸¡ì •ë²•

![02](/img/MachineLearning/06-02.png){: width="100%"}

- **ë§¨í•´íŠ¼ ê±°ë¦¬(Manhattan Distance; L1)** : ë‘ ì  ì‚¬ì´ì˜ ì—£ì§€(Edge) ê°¯ìˆ˜

    - $\overrightarrow{i_{1}}, \overrightarrow{i_{2}}, \cdots, \overrightarrow{i_{n}}$ ë¥¼ ê¸°ì €ë²¡í„°ë¡œ ì‚¬ìš©í•˜ëŠ” $n$ ì°¨ì› ì¢Œí‘œê³„ì— ìœ„ì¹˜í•œ ë‘ ë²¡í„° $\overrightarrow{a}, \overrightarrow{b}$ ì— ëŒ€í•˜ì—¬ ê° ì¶• ë°©í–¥ìœ¼ë¡œì˜ ê¸°ì €ë²¡í„° ë‹¨ìœ„ ê±°ë¦¬ë¥¼ í•©ì‚°í•œ ê°’

- **ê³„ì‚° ë°©ë²•**

    - ë²¡í„° $\overrightarrow{a},\overrightarrow{b}$ ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•˜ì

        $$\begin{aligned}
        \overrightarrow{a}
        &= \begin{pmatrix}a_1&a_2&\cdots&a_n\end{pmatrix}\\
        \overrightarrow{b}
        &= \begin{pmatrix}b_1&b_2&\cdots&b_n\end{pmatrix}
        \end{aligned}$$

    - $\overrightarrow{a}$ ì™€ $\overrightarrow{b}$ ì˜ ë§¨í•´íŠ¼ ê±°ë¦¬ $d_{L1}(\overrightarrow{a},\overrightarrow{b})$ ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ

        $$\begin{aligned}
        d(\overrightarrow{a},\overrightarrow{b})
        &= || \overrightarrow{a} - \overrightarrow{b} ||_{L1} \\
        &= \displaystyle\sum_{i=1}^{n} |a_i - b_i|
        \end{aligned}$$

### ìœ í´ë¦¬ë“œ ê±°ë¦¬ ì¸¡ì •ë²•

![03](/img/MachineLearning/06-03.png){: width="100%"}

- **ìœ í´ë¦¬ë“œ ê±°ë¦¬(Euclidean Distance; L2)** : ë‘ ì  ì‚¬ì´ì˜ ì§ì„  ê±°ë¦¬
    - $\overrightarrow{i_{1}}, \overrightarrow{i_{2}}, \cdots, \overrightarrow{i_{n}}$ ë¥¼ ê¸°ì €ë²¡í„°ë¡œ ì‚¬ìš©í•˜ëŠ” $n$ ì°¨ì› ì¢Œí‘œê³„ì— ìœ„ì¹˜í•œ ë‘ ë²¡í„° $\overrightarrow{a}, \overrightarrow{b}$ ì— ëŒ€í•˜ì—¬ ê° ì¶• ë°©í–¥ìœ¼ë¡œì˜ ê¸°ì €ë²¡í„° ë‹¨ìœ„ ê±°ë¦¬ì˜ ì œê³±ì„ í•©ì‚°í•œ í›„ ì œê³±ê·¼í•œ ê°’

- **ê³„ì‚° ë°©ë²•**
    - ë²¡í„° $\overrightarrow{a},\overrightarrow{b}$ ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•˜ì

        $$\begin{aligned}
        \overrightarrow{a}
        &= \begin{pmatrix}a_1&a_2&\cdots&a_n\end{pmatrix}\\
        \overrightarrow{b}
        &= \begin{pmatrix}b_1&b_2&\cdots&b_n\end{pmatrix}
        \end{aligned}$$

    - $\overrightarrow{a}$ ì™€ $\overrightarrow{b}$ ì˜ ìœ í´ë¦¬ë“œ ê±°ë¦¬ $d_{L2}(\overrightarrow{a},\overrightarrow{b})$ ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ

        $$\begin{aligned}
        d(\overrightarrow{a},\overrightarrow{b})
        &= || \overrightarrow{a} - \overrightarrow{b} ||_{L2} \\
        &= \sqrt{\displaystyle\sum_{i=1}^{n} (a_i - b_i)^2}
        \end{aligned}$$

### ì½”ì‚¬ì¸ ê±°ë¦¬ ì¸¡ì •ë²•

![04](/img/MachineLearning/06-04.png){: width="100%"}

- **ì½”ì‚¬ì¸ ê±°ë¦¬(Cosine Distance; $\cos$)** : ì„ì˜ì˜ ë‘ ì ì— ëŒ€í•˜ì—¬, ì›ì ê³¼ ê° ì ì„ ì‡ëŠ” ì§ì„ ì˜ ì‚¬ì´ê° $\theta$ ì˜ ì½”ì‚¬ì¸ ê°’

- **ê³„ì‚° ë°©ë²•**
    - ë²¡í„° $\overrightarrow{a},\overrightarrow{b}$ ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•˜ì

        $$\begin{aligned}
        \overrightarrow{a}
        &= \begin{pmatrix}a_1&a_2&\cdots&a_n\end{pmatrix}\\
        \overrightarrow{b}
        &= \begin{pmatrix}b_1&b_2&\cdots&b_n\end{pmatrix}
        \end{aligned}$$

    - $\overrightarrow{a}$ ì™€ $\overrightarrow{b}$ ì˜ ì½”ì‚¬ì¸ ê±°ë¦¬ $d_{cos}(\overrightarrow{a},\overrightarrow{b})$ ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ

        $$\begin{aligned}
        d(\overrightarrow{a},\overrightarrow{b})
        &= \cos{\theta}\\
        &= \frac{\overrightarrow{a}^{T}\overrightarrow{b}}{||a||\cdot||b||}\\
        &= \frac{\sum_{i=1}^{n}{a_{i}b_{i}}}{\sqrt{\sum_{i=1}^{n}{a_{i}^{2}}} \cdot \sqrt{\sum_{i=1}^{n}{b_{i}^{2}}}}\;(a_{i^{\forall}}\in\overrightarrow{a},b_{i^{\forall}}\in\overrightarrow{b})
        \end{aligned}$$

### í•˜ë²„ì‚¬ì¸ ê±°ë¦¬ ì¸¡ì •ë²•

![05](/img/MachineLearning/06-05.png){: width="100%"}

- **í•˜ë²„ì‚¬ì¸ ê±°ë¦¬(Haversine Distance; $\text{hav}$)** : êµ¬ í‘œë©´ìƒì— ì¡´ì¬í•˜ëŠ” ë‘ ì§€ì ì— ëŒ€í•˜ì—¬, ìœ„ë„($\varphi$), ê²½ë„($\lambda$) ë° í˜¸ ì¤‘ì‹¬ê°($\Theta$)ì„ í™œìš©í•˜ì—¬ ì¸¡ì •í•œ í˜¸ì˜ ê¸¸ì´

- **ê³„ì‚° ë°©ë²•**
    - ë°˜ì§€ë¦„ì´ $r$, í˜¸ $\overline{AB}$ ì˜ ì¤‘ì‹¬ê°ì´ $\Theta$ ì¼ ë•Œ, í˜¸ $\overline{AB}$ ì˜ ê¸¸ì´ $d(A,B)$ ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ

        $$\begin{aligned}
        d(A,B)
        &= r \cdot \Theta
        \end{aligned}$$

    - ì  $A$,$B$ ì˜ ìœ„ë„ê°€ $\varphi_{A}$,$\varphi_{B}$, ê²½ë„ê°€ $\lambda_{A}$,$\lambda_{B}$ ì´ê³ , í˜¸ $\overline{AB}$ ì˜ ì¤‘ì‹¬ê°ì´ $\Theta$ ì¼ ë•Œ, í˜¸ì˜ ê¸¸ì´ $\text{hav}{\Theta}$ ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ

        $$\begin{aligned}
        \text{hav}{\Theta}
        &= \text{hav}(\varphi_{B}-\varphi_{A})
        + \cos{\varphi_{A}} \cdot \cos{\varphi_{B}} \cdot \text{hav}(\lambda_{B}-\lambda_{A})
        \end{aligned}$$

    - $\sin$, $\cos$, $\text{hav}$ ì˜ ê´€ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ

        $$\begin{aligned}
        \text{hav}{\Theta}
        &= \sin^{2}{\frac{\Theta}{2}}\\
        &= \frac{1-\cos{\Theta}}{2}
        \end{aligned}$$

    - ë”°ë¼ì„œ ë°˜ì§€ë¦„, ê²½ë„, ìœ„ë„ê°€ ì£¼ì–´ì¡Œì„ ë•Œ í˜¸ $\overline{AB}$ ì˜ ê¸¸ì´ $d(A,B)$ ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ

        $$\begin{aligned}
        d(A,B)
        &= r \cdot \Theta\\
        &= r \cdot \text{archav}(\text{hav}{\Theta})\\
        &= 2r \cdot \arcsin(\sqrt{\text{hav}{\Theta}})\\
        &= 2r \cdot \arcsin\left(\sqrt{\text{hav}(\varphi_{B}-\varphi_{A}) + \cos{\varphi_{A}} \cdot \cos{\varphi_{B}} \cdot \text{hav}(\lambda_{B}-\lambda_{A})}\right)
        \end{aligned}$$

# ğŸ’¡ [sklearn.neighbors.KNeighborsClassifier](https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html#sklearn-neighbors-kneighborsclassifier)
-----

```python
from sklearn.neighbors import KNeighborsClassifier
```

### General HyperParameter

- `n_jobs(default : None)` : ë³‘ë ¬ë¡œ ì‘ì—…í•  ì½”ì–´ ê°¯ìˆ˜

### Model HyperParameter

- `n_neighbors(default : 5)` : ì°¸ì¡°í•  ê·¼ì ‘ ë²¡í„°ì˜ ê°¯ìˆ˜

- `metric(default : 'minkowski')` : ê±°ë¦¬ ì¸¡ì • ë°©ë²•
    - `'l1'`, `'manhattan'` or `'cityblock'` : ë§¨í•´íŠ¼ ê±°ë¦¬ ì¸¡ì •ë²•
    - `'l2'` or `'euclidean'` : ìœ í´ë¦¬ë“œ ê±°ë¦¬ ì¸¡ì •ë²•
    - `'cosine'` : ì½”ì‚¬ì¸ ê±°ë¦¬ ì¸¡ì •ë²•
    - `'haversine'` : í•˜ë²„ì‚¬ì¸ ê±°ë¦¬ ì¸¡ì •ë²•
    - `callable`

- `p(default : 2)` : `metric` ì˜ ì•„ê·œë¨¼íŠ¸ê°€ `'minkowski'` ì¸ ê²½ìš° ì¶”ê°€ ì„¤ì •

    $$
    minkowski=\left(\displaystyle\sum_{i=1}^{n}{|x_i-y_i|^p}\right)^{\frac{1}{p}}
    $$

    - `1` : ë§¨í•´íŠ¼ ê±°ë¦¬ ì¸¡ì •ë²•
    - `2` : ìœ í´ë¦¬ë“œ ê±°ë¦¬ ì¸¡ì •ë²•

- `weights(default : 'uniform')` : ê·¼ì ‘ ë²¡í„°ì— ëŒ€í•˜ì—¬ ê°€ì¤‘ì¹˜ ë¶€ì—¬ ë°©ë²• ì„¤ì •
    - `None`
    - `'uniform'` : ê·¼ì ‘ ë²¡í„°ì— ëŒ€í•˜ì—¬ ë™ë“±í•œ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•¨
    - `'distance'` : ê·¼ì ‘ ë²¡í„°ì— ëŒ€í•˜ì—¬ ê±°ë¦¬ì— ë”°ë¥¸ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•¨
    - `callable`

-----

### ì´ë¯¸ì§€ ì¶œì²˜

- https://076923.github.io/posts/Python-opencv-43/