## Index

1. t-SNE
2. ìˆ˜í•™ì  ì´í•´
3. `sklearn.manifold.TSNE`

<hr></br>

## What? t-SNE

### ğŸ’¡ `S`tochastic `N`eighbor `E`mbedding

- **ì •ì˜** : ê´€ì¸¡ì¹˜ ê°„ ê³ ì°¨ì› ê³µê°„ ìƒ í™•ë¥ ì  ìœ ì‚¬ë„ë¥¼ ë³´ì¡´í•˜ë©´ì„œ ì €ì°¨ì›ìœ¼ë¡œ ë§¤í•‘í•˜ëŠ” ë¹„ì„ í˜• ì°¨ì› ì¶•ì†Œ

    <p align="center"><img alt="ë‹¤ì–‘ì²´í•™ìŠµ" src="https://user-images.githubusercontent.com/116495744/224497076-8a2e6100-88a5-444c-abb9-377e61e961ee.jpeg" width=80%></p>

### ğŸ’¡ `t`-distributed `S`tochastic `N`eighbor `E`mbedding

- **SNEì˜ ë¬¸ì œì ** : Crowding Problem

    <p align="center"><img alt="ê°€ìš°ì‹œì•ˆ" src="https://github.com/jayarnim/jayarnim/assets/116495744/1a3abcc6-062c-469e-9d44-aba6e5f3ecb0" width=80%></p>

    - ê°€ìš°ì‹œì•ˆ ë¶„í¬ëŠ” ì–‘ìª½ ê¼¬ë¦¬ ë¶€ë¶„ì´ ì¶©ë¶„íˆ ë‘í…ì§€ ì•Šì€ í˜•íƒœë¥¼ ë³´ì„
    - ì¦‰, í™•ë¥ ë³€ìˆ˜ $||\overrightarrow{x}_{i}-\overrightarrow{x}_{j}||$ ê°€ ì¼ì •í•œ ê°’ ì´ìƒë¶€í„°ëŠ” ìœ ì‚¬ë„ì— í° ì°¨ì´ê°€ ì—†ìŒ

- **t-SNEì˜ í•´ê²°ì±…** : Student t-Dristribution

    <p align="center"><img alt="studentt" src="https://github.com/jayarnim/jayarnim/assets/116495744/61a37781-b23f-424a-8193-8898a8850505" width=80%></p>

    $$\begin{aligned}
    T
    &= \frac{Z}{\sqrt{\displaystyle\frac{V}{\nu}}}\\
    V
    &= \sum_{i=1}^{k}{Z_{i}^{2}}
    \end{aligned}$$

    - $Z$ : í‘œì¤€ ê°€ìš°ì‹œì•ˆ ë¶„í¬
    - $V$ : ììœ ë„ê°€ $\nu$ ì¸ ì¹´ì´ì œê³± ë¶„í¬

</br>

## ìˆ˜í•™ì  ì´í•´

### ğŸ’¡ ë‘ ê´€ì¸¡ì¹˜ì˜ ê³ ì°¨ì› ê³µê°„ ìƒ ìœ ì‚¬ë„ ë„ì¶œ

- í™•ë¥ ë³€ìˆ˜ $X$ ê°€ ê°€ìš°ì‹œì•ˆ ë¶„í¬ $N(\mu, \sigma^{2})$ ì„ ë”°ë¥¸ë‹¤ê³  í–ˆì„ ë•Œ, $X$ ì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ

    $$\begin{aligned}
    f(x)
    &= \frac{1}{\sqrt{2\pi\sigma^{2}}}\exp{\left[-\frac{(x-\mu)^{2}}{2\sigma^{2}}\right]}
    \end{aligned}$$

- **ê´€ì¸¡ì¹˜ $\overrightarrow{x}_{i}$ ë¡œë¶€í„°ì˜ ê±°ë¦¬ì— ëŒ€í•œ $\overrightarrow{x}_{i}$ ì™€ì˜ ìœ ì‚¬ë„**ì˜ ê°€ìš°ì‹œì•ˆ ë¶„í¬ì— ê¸°ì´ˆí–ˆì„ ë•Œ, $\overrightarrow{x}_{j}$ ê°€ $\overrightarrow{x}_{i}$ ì™€ ìœ ì‚¬í•  ê°€ëŠ¥ì„±ì„ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•˜ì

    $$\begin{aligned}
    p_{j|i} 
    = \frac{\exp{\left[-\frac{||\overrightarrow{x}_{i}-\overrightarrow{x}_{j}||^{2}}{2\sigma^{2}}\right]}}{\sum_{k \ne i}{\exp{\left[-\frac{||\overrightarrow{x}_{i}-\overrightarrow{x}_{k}||^{2}}{2\sigma^{2}}\right]}}}\\\\

    ||\overrightarrow{x}_{i}-\overrightarrow{x}_{j}|| \sim N_{i}(0,\sigma^{2})
    \end{aligned}$$

- **ë˜í•œ ê´€ì¸¡ì¹˜ $\overrightarrow{x}_{j}$ ë¡œë¶€í„°ì˜ ê±°ë¦¬ì— ëŒ€í•œ $\overrightarrow{x}_{j}$ ì™€ì˜ ìœ ì‚¬ë„**ì˜ ê°€ìš°ì‹œì•ˆ ë¶„í¬ì— ê¸°ì´ˆí–ˆì„ ë•Œ, $\overrightarrow{x}_{i}$ ê°€ $\overrightarrow{x}_{j}$ ì™€ ìœ ì‚¬í•  ê°€ëŠ¥ì„±ì„ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•˜ì

    $$\begin{aligned}
    p_{i|j}
    = \frac{\exp{\left[-\frac{|\overrightarrow{x}_{i}-\overrightarrow{x}_{j}|^{2}}{2\sigma^{2}}\right]}}{\sum_{k \ne j}{\exp{\left[-\frac{|\overrightarrow{x}_{j}-\overrightarrow{x}_{k}|^{2}}{2\sigma^{2}}\right]}}}\\\\

    ||\overrightarrow{x}_{i}-\overrightarrow{x}_{j}|| \sim N_{j}(0,\sigma^{2})
    \end{aligned}$$

- ë‘ ê°€ëŠ¥ì„±ì€ **ì„œë¡œ ë‹¤ë¥¸ í™•ë¥  ë¶„í¬ì— ê¸°ì´ˆí•˜ê³  ìˆìœ¼ë¯€ë¡œ** ê·¸ ê°’ì´ ë°˜ë“œì‹œ ì¼ì¹˜í•œë‹¤ê³  ë³¼ ìˆ˜ ì—†ìŒ

    $$
    p_{j|i} \ne p_{i|j}
    $$

- ë”°ë¼ì„œ $\overrightarrow{x}_{i}$ ì™€ $\overrightarrow{x}_{j}$ ì˜ ìœ ì‚¬ë„ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•¨

    $$\begin{aligned}
    p_{i,j}
    &= \frac{p_{j|i} + p_{i|j}}{2n}
    \end{aligned}$$

### ğŸ’¡ ë‘ ê´€ì¸¡ì¹˜ì˜ 2ì°¨ì› ê³µê°„ ìƒ ìœ ì‚¬ë„ ë„ì¶œ

- **ê´€ì¸¡ì¹˜ $\overrightarrow{y}_{i}$ ë¡œë¶€í„°ì˜ ê±°ë¦¬ì— ëŒ€í•œ $\overrightarrow{y}_{i}$ ì™€ì˜ ìœ ì‚¬ë„**ì˜ ê°€ìš°ì‹œì•ˆ ë¶„í¬ì— ê¸°ì´ˆí–ˆì„ ë•Œ, $\overrightarrow{y}_{j}$ ê°€ $\overrightarrow{y}_{i}$ ì™€ ìœ ì‚¬í•  ê°€ëŠ¥ì„±ì„ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•˜ì

    $$\begin{aligned}
    q_{j|i} 
    = \frac{\exp{\left[-||\overrightarrow{y}_{i}-\overrightarrow{y}_{j}||^{2}\right]}}{\sum_{k \ne i}{\exp{\left[-||\overrightarrow{y}_{i}-\overrightarrow{y}_{k}||^{2}\right]}}}\\\\

    ||\overrightarrow{y}_{i}-\overrightarrow{y}_{j}|| \sim N_{i}(0,\sigma^{2})
    \end{aligned}$$

    - $\overrightarrow{y}$ : ê³ ì°¨ì› ê³µê°„ ìƒì˜ ê´€ì¸¡ì¹˜ ë²¡í„° $\overrightarrow{x}$ ë¥¼ 2ì°¨ì› ê³µê°„ ìƒì— ë§¤í•‘í•œ ë²¡í„°

- $\overrightarrow{y}_{i}$ ì™€ $\overrightarrow{y}_{j}$ ì˜ ìœ ì‚¬ë„ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•¨

    $$\begin{aligned}
    q_{i,j}
    &= \frac{q_{j|i} + q_{i|j}}{2n}
    \end{aligned}$$

### ğŸ’¡ ë¹„ìš©í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” ì•„ê·œë¨¼íŠ¸ ë„ì¶œ

- **KL(Kullback-Leibler Divergence)** : í™•ë¥ ë³€ìˆ˜ $X$ ì˜ ë™ì¼í•œ ì•„ê·œë¨¼íŠ¸ $x_{i}$ ì— ëŒ€í•˜ì—¬ ë‘ í™•ë¥  ë¶„í¬ $P,Q$ ì˜ ì°¨ì´ë¥¼ ì¸¡ì •í•˜ëŠ” ì§€í‘œ

    $$
    \text{KL}(P|Q)
    = \sum_{i=1}^{n}{P(X=x_{i})\cdot\log{\frac{P(X=x_{i})}{Q(X=x_{i})}}}
    $$

- KLì— ê¸°ì´ˆí•œ ë¹„ìš©í•¨ìˆ˜ ì •ì˜

    $$\begin{aligned}
    Cost
    &= \sum_{i}{\text{KL}(P_{i}|Q_{i})}\\
    &= \sum_{i}{\sum_{j}{p_{i,j}\cdot\log{\frac{p_{i,j}}{q_{i,j}}}}}
    \end{aligned}$$

- $\hat{\mathbf{Y}}$ ë„ì¶œ

    $$\begin{aligned}
    \hat{\mathbf{Y}}
    &= \{\hat{\overrightarrow{y}}_{i}|\argmin_{\overrightarrow{y}_{i}}{Cost}\}
    \end{aligned}$$

</br>

## [`sklearn.manifold.TSNE`](https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html#sklearn-manifold-tsne)

```python
from sklearn.manifold import TSNE
```

### ğŸ’¡ General HyperParameter

- `random_state = None`
- `n_jobs(default : None)` : ë³‘ë ¬ë¡œ ì‘ì—…í•  ì½”ì–´ ê°¯ìˆ˜

### ğŸ’¡ Model HyperParameter

- `n_components(default : 2)` : ì¶•ì†Œí•  ì°¨ì›ì˜ ê°¯ìˆ˜
- `metric(default : 'euclidean')` : ê´€ì¸¡ì¹˜ ê°„ ê¸°í•˜ ê±°ë¦¬ ì¸¡ì • ë°©ë²•
- `perplexity(default : 30.0)` : ì°¸ì¡°í•  Nearest Neighbors ê°¯ìˆ˜ë¡œì„œ 5~50 ì‚¬ì´ì˜ ê°’ì„ ê¶Œì¥í•¨
- `early_exaggeration(default :12.0)` : `perplexity` ì— ê¸°ì´ˆí•˜ì—¬ í˜•ì„±ëœ êµ°ì§‘ ê°„ ê±°ë¦¬

### ğŸ’¡ Learning Task HyperParameter

- `learning_rate(default : 'auto')` : í•™ìŠµë¥ 
- `n_iter(default : 1000)` : ë‹¤ì–‘ì²´ íƒìƒ‰ íšŸìˆ˜ë¡œì„œ 250 ì´ìƒì˜ ê°’ì„ ê¶Œì¥í•¨
- `n_iter_without_progress(default : 300)` : ì†ì‹¤ í•¨ìˆ˜ê°€ ëª‡ ë²ˆ ì´ìƒ ê°œì„ ë˜ì§€ ì•Šì„ ê²½ìš° í•™ìŠµì„ ì¤‘ë‹¨í•  ê²ƒì¸ê°€