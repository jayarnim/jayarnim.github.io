---
order: 9
title: Latent Factor Models with CNN
date: 2024-05-01
categories: [AI Application, Recommender System]
tags: [AI Application, Recommender System, Collaborative Filtering, Latent Factor Model, MLP, CNN]
math: true
description: >-
    Based on the following lectures <br>
    (1) “Recommendation System Design (2024-1)” by Prof. Ha Myung Park, Dept. of Artificial Intelligence. College of SW, Kookmin Univ. <br>
    (2) "Recommender System (2024-2)" by Prof. Hyun Sil Moon, Dept. of Data Science, The Grad. School, Kookmin Univ.
image:
    path: /_post_refer_img/RecommenderSystem/Thumbnail.jpg
---

## How to aggregate
-----

![01](/_post_refer_img/RecommenderSystem/09-01.png){: width="100%"}

- **요소별 곱(Element-wise Product)**: 두 벡터 간 상응하는 차원끼리 곱셈하는 방법
    - 사용자, 아이템 잠재요인 공간 동일 가정
    - 잠재요인 차원 간 독립성 가정
    - 사용자-아이템 쌍별(Pairwise) 상호작용(Interaction) 신호 반영 표현
    - 동일 차원 상호작용만 포착하므로 다차원 상호작용 반영 불가

- **벡터 결합(Vector Concatenation)**: 두 벡터를 결합하는 방법
    - 사용자, 아이템 잠재요인 공간 독립 가정
    - 사용자, 아이템 벡터 정보 보존 표현
    - 모형이 사용자-아이템 쌍별(Pairwise) 상호작용(Interaction) 신호 직접 학습

- **외적(Outer Product)**: 두 벡터 간 외적하는 방법
    - 사용자, 아이템 잠재요인 공간 동일 가정
    - 잠재요인 차원 간 종속성 가정
    - 그 대각성분은 요소별 곱셈에서 포착하는 동일 차원 간 상호작용 신호에 해당함

## ConvNCF
-----

- **문제 의식**: `NeuMF` 의 다차원 고차 상호작용 포착 한계점
    - `GMF` 는 동일 차원 상호작용만 포착하므로 다차원 고차 상호작용 반영 불가
    - `NCF` 는 다양한 매칭 함수 근사 가능하나 고차원 입력 시 파라미터 수 폭증

- [**`ConvNCF`**](https://doi.org/10.48550/arXiv.1808.03912): 외적과 합성곱 신경망을 활용하여 다차원 간 고차 상호작용을 포착하는 단일 모형
    - He, X., Du, X., Wang, X., Tian, F., Tang, J., & Chua, T. S.\\
    (2018).\\
    Outer product-based neural collaborative filtering.\\
    arXiv preprint arXiv:1808.03912.

### How to Modeling

![05](/_post_refer_img/RecommenderSystem/09-02.png){: width="100%"}

- **Annotation**
    - $u=1,2,\cdots,M$: user idx
    - $i=1,2,\cdots,N$: item idx
    - $\overrightarrow{\mathbf{u}}_{u} \in \mathbb{R}^{K}$: user latent factor vector
    - $\overrightarrow{\mathbf{v}}_{i} \in \mathbb{R}^{K}$: item latent factor vector
    - $\mathbf{E}_{u,i} \in \mathbb{R}^{K \times K}$: interaction map of user $u$ and item $i$
    - $\overrightarrow{\mathbf{x}}_{u,i}$: interdimensional high-level interaction vector of user $u$ and item $i$
    - $\overrightarrow{\mathbf{z}}_{u,i} \in \mathbb{R}^{K}$: predictive vector of user $u$ and item $i$
    - $\hat{y}_{u,i}$: interaction probability of user $u$ and item $i$

- Outer product of user $u$ and item $i$:

    $$\begin{aligned}
    \mathbf{E}_{u,i}
    &= \overrightarrow{\mathbf{u}}_{u} \otimes \overrightarrow{\mathbf{v}}_{i}
    \end{aligned}$$

- Capture interdimensional high-level interaction of user $u$ and item $i$: 

    ![06](/_post_refer_img/RecommenderSystem/09-03.png){: width="100%"}

    $$\begin{aligned}
    \overrightarrow{\mathbf{x}}_{u,i}
    &= \text{Flatten}\left[\text{Conv}_{\text{ReLU}}(\mathbf{E}_{u,i})\right]
    \end{aligned}$$

- Predictive Vector of user $u$ and item $i$:

    $$\begin{aligned}
    \overrightarrow{\mathbf{z}}_{u,i}
    &= \text{MLP}_{\text{ReLU}}(\overrightarrow{\mathbf{x}}_{u,i})
    \end{aligned}$$

- Predict interaction probability of user $u$ and item $i$:

    $$\begin{aligned}
    \hat{y}_{u,i}
    &= \sigma(\mathbf{W} \cdot \overrightarrow{\mathbf{z}}_{u,i} + \overrightarrow{\mathbf{b}})
    \end{aligned}$$

## COMET
-----