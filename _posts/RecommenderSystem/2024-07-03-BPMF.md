---
order: 16
title: BPMF
date: 2024-07-03
categories: [AI & Data Mining, Recommender System]
tags: [Paper Review, Data Mining, RecSys, Collaborative Filtering, Latent Factor Model, Bayesian]
math: true
description: >-
    <ul type="square">
    <li><strong>Title</strong>: <a href="https://dl.acm.org/doi/abs/10.1145/1390156.1390267?casa_token=qcXfuanisHUAAAAA:1kvcFcEIDLbBTKptsE1CPjTQToi0mpGtJpYS7hHSTW2yKdoT2pUpNdfY7TARrnNdKC2FaIqIaULwOow"><em>Bayesian Probabilistic Matrix Factorization using Markov Chain Monte Carlo</em></a></li>
    <li><strong>Author</strong>: <em>R. Salakhutdinov and A. Mnih</em></li>
    <li><strong>Publisher</strong>: <em>ICML</em></li>
    <li><strong>Published</strong>: <em>2008</em></li>
    </ul>
image:
    path: /_post_refer_img/RecommenderSystem/Thumbnail.jpg
---

## Pilot Study
-----

### MF

- **행렬분해(`M`atrix `F`actorization; MF)** : 잠재요인 모형의 원형으로서, 사용자-아이템 상호작용 행렬 $\mathbf{R} \in \mathbb{R}^{M \times N}$ 을 행렬분해하여 $K$ 차원 잠재요인(Latent Factor) 공간에 사용자-잠재요인 $\mathbf{U} \in \mathbb{R}^{M \times K}$ 와 아이템-잠재요인 $\mathbf{V} \in \mathbb{R}^{N \times K}$ 을 공동으로 사상하는 방법

- **Model**

    $$\begin{aligned}
    \mathbf{R} &\approx \mathbf{U}\mathbf{V}^{T}
    \end{aligned}$$

- **Params**
    - $\mathbf{U}$ : User-Latent Factor Matrix
    - $\mathbf{V}$ : Item-Latent Factor Matrix

- **Hyper-Params**
    - $K$ : Dimension of Latent Factor

- **Objective Function**

    $$\begin{aligned}
    \hat{\mathbf{U}}, \hat{\mathbf{V}}
    &= \text{arg} \min_{\mathbf{U},\mathbf{V}}{\text{Loss}\left(\mathbf{U}\mathbf{V}^{T}, \mathbf{R}\right)}
    \end{aligned}$$

### PMF

- **확률적 행렬분해(`P`robabilistic `M`atrix `F`actorization; PMF)** : 행렬분해의 학습파라미터 $\mathbf{U},\mathbf{V}$ 추정 시 정보 불확실성을 반영하기 위해 이를 상수에서 확률변수화하고, 최대사후확률(`M`aximum `a` `P`osteriori; MAP)로서 베이즈 액션(Bayes' Action)을 취하는 방법

- **Model**
    - Prior of User-Latent Factor : $\mathbf{U} \sim \mathcal{N}\left(\mu_{U}, \lambda_{U}^{-1}\cdot\mathbf{I}\right)$
    - Prior of Item-Latent Factor : $\mathbf{V} \sim \mathcal{N}\left(\mu_{V}, \lambda_{V}^{-1}\cdot\mathbf{I}\right)$
    - Likelihood : $\mathbf{R} \mid \mathbf{U},\mathbf{V} \sim \mathcal{N}\left(\mathbf{U}\mathbf{V}^{T}, \sigma^{2}\right)$
    - Log Posterior of Params : $\log{P\left(\mathbf{U},\mathbf{V}\mid\mathbf{R}\right)} \propto \log{P\left(\mathbf{R}\mid\mathbf{U},\mathbf{V}\right)} + \log{P\left(\mathbf{U}\right)} + \log{P\left(\mathbf{V}\right)}$

- **Params**
    - $\mathbf{U}$ : User-Latent Factor Matrix
    - $\mathbf{V}$ : Item-Latent Factor Matrix

- **Hyper-Params**
    - $K$ : Dimension of Latent Factor
    - $\mu_{U}$ : Mean of User-Latent Factor
    - $\mu_{V}$ : Mean of Item-Latent Factor
    - $\lambda_{U}^{-1}$ : Variance of User-Latent Factor
    - $\lambda_{V}^{-1}$ : Variance of Item-Latent Factor
    - $\sigma^{2}$ : Noise of User-Item Interaction

- **Objective Function**

    $$\begin{aligned}
    \hat{\mathbf{U}}, \hat{\mathbf{V}}
    &= \text{arg} \max_{\mathbf{U},\mathbf{V}}{\log{P\left(\mathbf{U},\mathbf{V}\mid\mathbf{R}\right)}}
    \end{aligned}$$